(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{71:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(35),a=n.n(c),s=n(4),u=n(0),o=function(){var e=Object(s.c)((function(e){return e.notification}));return""!==e[0]&&!1===e[1]?Object(u.jsx)("div",{className:"success",children:e}):""!==e[0]&&!0===e[1]?Object(u.jsx)("div",{className:"error",children:e}):null},i=n(2),l=n.n(i),d=n(5),b=n(8),j=n(13),f=n.n(j),p="/api/blogs",h=null,O=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,f.a.post(p,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(d.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("".concat(p,"/").concat(t.id,"/comments"),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x={getAll:function(){return f.a.get(p).then((function(e){return e.data}))},create:O,addLike:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,f.a.put("".concat(p,"/").concat(t.id),t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:m,deleteBlog:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,f.a.delete("".concat(p,"/").concat(t.id),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){h="bearer ".concat(e)}},v=n(12),g={login:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y=Object(v.b)({name:"user",initialState:null,reducers:{setUser:function(e,t){return t.payload},clearUser:function(e,t){return null}}}),w=function(e){return function(){var t=Object(d.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.login(e);case 2:return r=t.sent,n(N(r)),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},k=y.actions,N=k.setUser,B=k.clearUser,S=y.reducer,C=null,L=Object(v.b)({name:"notification",initialState:"",reducers:{setSuccessNotification:function(e,t){return clearTimeout(C),[t.payload,!1]},setErrorNotification:function(e,t){return clearTimeout(C),[t.payload,!0]},removeNotification:function(e,t){return["",!1]}}}),A=function(e,t){switch(t){case!0:return function(t){t(U(e)),C=setTimeout((function(){return t(I(""))}),5e3)};default:return function(t){t(R(e)),C=setTimeout((function(){return t(I(""))}),5e3)}}},F=L.actions,I=(F.setInternalNotification,F.removeNotification),R=F.setSuccessNotification,U=F.setErrorNotification,T=L.reducer,E=function(){var e=Object(r.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),o=Object(b.a)(a,2),i=o[0],j=o[1],f=Object(s.b)(),p=function(){var e=Object(d.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,f(w({username:n,password:i}));case 4:r=e.sent,x.setToken(r.token),window.localStorage.setItem("loggedBlogUser",JSON.stringify(r)),c(""),j(""),f(A("Logged in as "+r.username,!1)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),f(A("Incorrect username or password",!0));case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{children:[Object(u.jsx)("h2",{children:"Login"}),Object(u.jsxs)("form",{onSubmit:p,children:[Object(u.jsxs)("div",{children:["username",Object(u.jsx)("input",{type:"text",value:n,name:"Username",id:"username",onChange:function(e){var t=e.target;return c(t.value)}})]}),Object(u.jsxs)("div",{children:["password",Object(u.jsx)("input",{type:"password",value:i,name:"Password",id:"password",onChange:function(e){var t=e.target;return j(t.value)}})]}),Object(u.jsx)("div",{children:Object(u.jsx)("button",{type:"submit",className:"btn btn-primary",id:"login-button",children:"login"})})]})]})},D=Object(r.forwardRef)((function(e,t){D.displayName=D;var n=Object(r.useState)(!1),c=Object(b.a)(n,2),a=c[0],s=c[1],o={display:a?"none":""},i={display:a?"":"none"},l=function(){return s(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{style:o,children:Object(u.jsxs)("button",{onClick:l,className:"btn btn-primary",children:[e.buttonLabel," "]})}),Object(u.jsxs)("div",{style:i,children:[e.children,Object(u.jsx)("button",{onClick:l,className:"btn btn-secondary",children:"cancel"})]})]})})),J=D,z=n(15),V=Object(v.b)({name:"blogs",initialState:[],reducers:{addBlog:function(e,t){var n=t.payload;e.push(n)},setBlogs:function(e,t){return t.payload.sort((function(e,t){return t.likes-e.likes}))},voteInternalBlog:function(e,t){var n=t.payload;return e.map((function(e){return e.id!==n.id?e:n})).sort((function(e,t){return t.likes-e.likes}))},deleteInternalBlog:function(e,t){var n=t.payload;return console.log(n),e.filter((function(e){return e.id!==n.id}))}}}),H=function(e){return function(){var t=Object(d.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.create(e);case 2:r=t.sent,n(q(r));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},P=function(e,t){return function(){var n=Object(d.a)(l.a.mark((function n(r){var c;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,x.addLike(e);case 2:c=n.sent,r(K(Object(z.a)(Object(z.a)({},c),{},{user:t})));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},W=function(e){return function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.deleteBlog(e);case 2:t.sent,n(M(e));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},_=V.actions,q=_.addBlog,G=_.setBlogs,K=_.voteInternalBlog,M=_.deleteInternalBlog,Q=V.reducer,X=function(e){var t=e.blogFormRef,n=Object(s.b)(),r=Object(s.c)((function(e){return e.user})),c=function(){var e=Object(d.a)(l.a.mark((function e(c){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),e.prev=1,e.next=4,n(H({author:c.target.author.value,title:c.target.title.value,url:c.target.url.value,likes:0,user:r}));case 4:n(A("Added a new blog: "+c.target.title.value+" by "+c.target.author.value,!1)),t.current.toggleVisibility(),c.target.author.value="",c.target.title.value="",c.target.url.value="",e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),n(A("Blog couldn\xb4t be added: "+e.t0,!0));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{children:[Object(u.jsx)("h2",{children:"add new blog"}),Object(u.jsxs)("form",{onSubmit:c,children:[Object(u.jsxs)("div",{children:["author:"," ",Object(u.jsx)("input",{name:"author",id:"authorField",placeholder:"Author name"})]}),Object(u.jsxs)("div",{children:["title:"," ",Object(u.jsx)("input",{name:"title",id:"titleField",placeholder:"Title name"})]}),Object(u.jsxs)("div",{children:["url:"," ",Object(u.jsx)("input",{name:"url",id:"urlField",placeholder:"url for blog"})]}),Object(u.jsx)("div",{children:Object(u.jsx)("button",{type:"submit",id:"addBlogButton",className:"btn btn-primary",children:"Add blog"})})]})]})},Y=function(e){var t=e.handleLogout,n=Object(s.c)((function(e){return e.user}));return Object(u.jsxs)("div",{className:"inline",children:[Object(u.jsxs)("p",{className:"inline",children:[n.name," logged in "]}),Object(u.jsxs)("button",{onClick:function(){return t()},className:"btn btn-primary",children:["Log out"," "]})]})},Z={getAll:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},$=n(3),ee=function(){var e=Object(s.c)((function(e){return e.users})),t=Object($.h)().id,n=e.find((function(e){return e.id===t}));return n?Object(u.jsxs)("div",{children:[Object(u.jsx)("h3",{children:n.name}),Object(u.jsx)("h4",{children:"added blogs"}),Object(u.jsx)("ul",{children:n.blogs.map((function(e){return Object(u.jsx)("li",{children:e.title},e.id)}))})]}):null},te=n(10),ne=function(){var e=Object(s.c)((function(e){return e.users}));return Object(u.jsx)("div",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsx)("h2",{children:"Users"}),Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:"name"}),Object(u.jsx)("td",{children:"blogs created"})]}),e.map((function(e){return Object(u.jsxs)("tr",{children:[Object(u.jsx)(te.b,{to:"/users/".concat(e.id),children:e.name}),Object(u.jsx)("td",{children:e.blogs.length})]},e.id)}))]})})},re=n(74),ce=function(){return f.a.get("/api/comments").then((function(e){return e.data}))},ae=Object(v.b)({name:"comments",initialState:[],reducers:{setComments:function(e,t){return t.payload},addComment:function(e,t){var n={blog:t.payload.blog.id,content:t.payload.content};e.push(n)}}}),se=function(e,t){return function(){var n=Object(d.a)(l.a.mark((function n(r){var c;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,x.addComment(e,{content:t});case 2:c=n.sent,r(ie(c));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},ue=ae.actions,oe=ue.setComments,ie=ue.addComment,le=ae.reducer,de=function(e){var t=e.blog,n=e.full,c=Object(r.useState)(!1),a=Object(b.a)(c,2),o=a[0],i=(a[1],Object(s.b)()),j=Object(s.c)((function(e){return e.user})),f=Object(s.c)((function(e){return e.comments})),p={display:o?"none":"",paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},h=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return event.preventDefault(),e.prev=1,e.next=4,i(P(t,t.user));case 4:i(A("Voted "+t.title+" by "+t.author)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i(A("Like couldn`t be added: "+e.t0,!0));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(event.preventDefault(),e.prev=1,!window.confirm("Do you really want to delete the blog?")){e.next=6;break}return e.next=5,i(W(t));case 5:i(A("Blog "+t.title+" by "+t.author+" has been deleted"));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),i(A("blog couldn`t be deleted: "+e.t0,!0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(d.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),console.log(t),e.prev=2,e.next=5,i(se(t,n.target.comment.value));case 5:i(A("Added a new comment: "+n.target.comment.value,!1)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),i(A("Comment couldn\xb4t be added: "+e.t0,!0));case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();return t?n?(console.log(t),Object(u.jsx)("div",{className:"blog",children:Object(u.jsxs)("div",{className:"fullContent",children:[Object(u.jsxs)("h2",{children:[t.title," "]}),Object(u.jsxs)("a",{href:t.url,target:"_blank",rel:"noreferrer",children:[t.url," "]}),Object(u.jsxs)("div",{children:[Object(u.jsxs)("p",{children:["likes ",t.likes]}),Object(u.jsx)("button",{onClick:function(){return i(h)},className:"btn btn-success",children:"Like"})]}),Object(u.jsx)("div",{children:t.user.name}),j.username===t.user.username&&Object(u.jsx)("div",{children:Object(u.jsx)("button",{onClick:function(){return O()},className:"btn btn-danger",children:"Remove"})}),Object(u.jsx)("h3",{children:"comments"}),Object(u.jsxs)("form",{onSubmit:m,children:[Object(u.jsx)("div",{children:Object(u.jsx)("input",{name:"comment",id:"commentField",placeholder:"Comment"})}),Object(u.jsx)("div",{children:Object(u.jsx)("button",{type:"submit",id:"addCommentButton",className:"btn btn-primary",children:"Add comment"})})]}),Object(u.jsx)("ul",{children:f.map((function(e){return e.blog===t.id?Object(u.jsx)("li",{children:e.content}):null}))})]})})):Object(u.jsx)("tr",{children:Object(u.jsx)("div",{className:"blog",children:Object(u.jsx)("div",{style:p,className:"partialContent",children:Object(u.jsxs)(te.b,{to:"/blogs/".concat(t.id),children:[t.title," ",t.author]})})})}):null},be=function(e){var t=Object(s.c)((function(e){return e.blogs}));return console.log(t),Object(u.jsx)("div",{children:Object(u.jsx)(re.a,{striped:!0,bordered:!0,hover:!0,children:Object(u.jsx)("tbody",{children:t.map((function(t){return Object(u.jsx)(de,{blog:t,user:e},t.id)}))})})})},je=function(e){var t=e.handleLogout,n={padding:5},r=Object(s.c)((function(e){return e.user}));return Object(u.jsxs)("div",{className:"navBar",children:[Object(u.jsx)(te.b,{style:n,to:"/",children:"home"}),Object(u.jsx)(te.b,{style:n,to:"/users",children:"users"}),Object(u.jsx)(te.b,{style:n,to:"/blogs",children:"blogs"}),r?Object(u.jsx)(Y,{style:{display:"inline"},handleLogout:t}):null]})},fe=function(e){var t=e.blogFormRef,n=Object(s.c)((function(e){return e.user}));return null!==n?Object(u.jsxs)("div",{children:[Object(u.jsx)(J,{buttonLabel:"Add a new blog",ref:t,children:Object(u.jsx)(X,{user:n,blogFormRef:t})}),Object(u.jsx)("h2",{children:"blogs"}),Object(u.jsx)(be,{user:n})]}):null},pe=Object(v.b)({name:"users",initialState:[],reducers:{setUsers:function(e,t){return t.payload}}}),he=pe.actions.setUsers,Oe=pe.reducer,me=function(e){var t=e.blogFormRef,n=Object(s.c)((function(e){return e.user}));return null!==n?Object(u.jsxs)("div",{children:[Object(u.jsx)(J,{buttonLabel:"Add a new blog",ref:t,children:Object(u.jsx)(X,{user:n,blogFormRef:t})}),Object(u.jsx)("h2",{children:"blogs"}),Object(u.jsx)(be,{user:n})]}):null},xe=function(){var e=Object(s.c)((function(e){return e.user})),t=Object(s.c)((function(e){return e.users})),n=Object(s.c)((function(e){return e.blogs})),c=(Object(s.c)((function(e){return e.comments})),Object($.f)("/blogs/:id")),a=c?n.find((function(e){return e.id===c.params.id})):null,i=Object(r.useRef)(),b=Object(s.b)();return Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogUser");if(e){var t=JSON.parse(e);b(N(t)),x.setToken(t.token)}}),[]),Object(r.useEffect)((function(){b(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getAll();case 2:n=e.sent,t(G(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[b]),Object(r.useEffect)((function(){b(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.getAll();case 2:n=e.sent,t(he(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[b]),Object(r.useEffect)((function(){b(function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:n=e.sent,t(oe(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[b]),Object(u.jsxs)("div",{children:[Object(u.jsx)(je,{handleLogout:function(){window.localStorage.removeItem("loggedBlogUser"),b(B()),b(A("Succesfully logged out",!1))}}),Object(u.jsxs)("div",{className:"container",children:[Object(u.jsx)("h1",{children:"Blogs"}),Object(u.jsx)(o,{}),null===e?Object(u.jsx)(E,{}):null,Object(u.jsxs)($.c,{children:[Object(u.jsx)($.a,{path:"/",element:Object(u.jsx)(me,{blogFormRef:i})}),Object(u.jsx)($.a,{path:"/blogs/:id",element:Object(u.jsx)(de,{full:!0,blog:a})}),Object(u.jsx)($.a,{path:"/users/:id",element:Object(u.jsx)(ee,{users:t})}),Object(u.jsx)($.a,{path:"/users",element:Object(u.jsx)(ne,{})}),Object(u.jsx)($.a,{path:"/blogs",element:Object(u.jsx)(fe,{blogFormRef:i})})]})]})]})},ve=(n(71),Object(v.a)({reducer:{blogs:Q,notification:T,user:S,users:Oe,comments:le}}));a.a.createRoot(document.getElementById("root")).render(Object(u.jsx)(s.a,{store:ve,children:Object(u.jsx)(te.a,{children:Object(u.jsx)(xe,{})})}))}},[[72,1,2]]]);
//# sourceMappingURL=main.3e7b56ad.chunk.js.map